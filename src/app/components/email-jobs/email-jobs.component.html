<!--<app-navbar></app-navbar>-->

<div class="container mt-5">
  <div class="box-area">
    <div class="row">
      <div class="col-md-12 email_inwrap">
        <app-errors></app-errors>
        <div class="alert alert-success mb-5" role="alert" *ngIf="isArchived">
          <div class="row align-items-center">
            <div class="col">
              <i class="fas fa-check-circle mr-2"></i>
              Archived Successfully.
            </div>
            <div class="col-auto">
              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <i class="fas fa-times-circle"></i>
              </button>
            </div>
          </div>
        </div>
        
        <mat-tab-group class="mat-group-content" [selectedIndex]="selectedTab" (selectedTabChange)="handleTabChange($event)">
            <div class="email_gp">
<<<<<<< HEAD
              <mat-tab label="Sent Emails (725)">
=======
              <mat-tab label="Sent Emails ({{jobsPage.totalElements}})">
>>>>>>> 283fbbfd1a39e2b7bb38af6e0ca912d4587bcd59
                <div class="menu_dot_area">
                  <button  class="border btn pr-3 pt-2 pb-2 pl-3" [matMenuTriggerFor]="menu_2">
                    <i class="fas fa-ellipsis-v"></i>
                  </button>
                  <mat-menu #menu_2="matMenu">
                    <a href="javascript:void(0)" mat-menu-item>Show/Hide Archive  &nbsp;
                      <mat-slide-toggle [(ngModel)]="isChecked"></mat-slide-toggle>
                    </a>
                    <a href="javascript:void(0)" mat-menu-item>
                      Unsubscribed Recipients
                    </a>
                  </mat-menu>
                </div> 
                <div class="table-container">
                  <table mat-table [dataSource]="sentEmailsDataSource" class="table hoverEffect table-header table-bordered table-rounded">
                    <ng-container matColumnDef="sent_on">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Sent</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">
                        <!-- {{element.created_at}} -->
                        Today 
                        <button mat-raised-button
                        matTooltip="Info about the action"
                        aria-label="Button that displays a tooltip when focused or hovered over">
                  Action
                </button>
                      </td>
                    </ng-container>
                    <ng-container matColumnDef="subject">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6> Subject</h6>
                      </th>
                      <td mat-cell *matCellDef="let element; let rowIndex = index">
                        {{element.subject}}
                      </td>
                    </ng-container>
      
                    <ng-container matColumnDef="email_template">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Email Template</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">New Course Marketing</td>
                    </ng-container>

                    <!-- <ng-container matColumnDef="status">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Status</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">{{element.status}}</td>
                    </ng-container> -->
      
                    <ng-container matColumnDef="no_of_recipients">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Recipients</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">{{element.no_of_recipients}}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="seen">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Seen</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">{{element.seen}}</td>
                    </ng-container>

                    <ng-container matColumnDef="unsubscribed">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Unsubscribed </h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">2</td>
                    </ng-container>
      
                    <ng-container matColumnDef="archive">
                      <th mat-header-cell *matHeaderCellDef>
                        
                      </th>
                      <td mat-cell class="hover_details" *matCellDef="let element">
                        <ul class="actiion_list">
                          <li>
                            <a class="btn-orange-outline-border" mwlConfirmationPopover [popoverTitle]="deletePopoverTitle"
                          [popoverMessage]="deletePopoverMessage" placement="left"
                          (confirm)="archiveEmailJob(element)">Archive</a>
                          </li>
                          <li>
                            <a (click)="loader = true" [routerLink]="'/Emails/View/'+element.id" class="btn-orange-outline-border">View</a>
                          </li>
                        </ul>
                    </td>
                    </ng-container>
      
                    <tr mat-header-row *matHeaderRowDef="displayedColumnsSentEmails"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumnsSentEmails;" (click)="$event.stopPropagation()">
                    </tr>
                  </table>
      
                  <app-custom-pagination [page]="jobsPage" (nextPageEvent)="getJobsNextPage()"
                    (previousPageEvent)="getJobsPreviousPage()">
                  </app-custom-pagination>
      
                </div>
      
              </mat-tab>
<<<<<<< HEAD
              <mat-tab label="Email Templates (5)">
=======
              <mat-tab label="Email Templates ({{allTemplatesPage.totalElements}})">
>>>>>>> 283fbbfd1a39e2b7bb38af6e0ca912d4587bcd59
                <div class="menu_dot_area">
                  <button  class="border btn pr-3 pt-2 pb-2 pl-3" [matMenuTriggerFor]="menu_2">
                    <i class="fas fa-ellipsis-v"></i>
                  </button>
                  <mat-menu #menu_2="matMenu">
                    <a href="javascript:void(0)" mat-menu-item>Show/Hide Archive  &nbsp;
                      <mat-slide-toggle [(ngModel)]="isChecked"></mat-slide-toggle>
                    </a>
                    <a href="javascript:void(0)" mat-menu-item>
                      Unsubscribed Recipients
                    </a>
                  </mat-menu>
                </div> 
                <button class="btn-orange-outline add_new_email_template" (click)="generateEmailTemplate()">
                  <i class="fas fa-plus"></i> Add New Email Template
                </button>
                <div class="table-container">
                  <table mat-table [dataSource]="emailTemplatesDataSource" class="table hoverEffect table-header table-bordered table-rounded">
                    <ng-container matColumnDef="created_on">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Created On</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">
                        <!-- {{element.created_at}} -->
                        Today 
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="subject">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Subject</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">
                        New Course Launched – Python and...
                      </td>
                    </ng-container>
      
                    <ng-container matColumnDef="email_templates">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Email Templates</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">{{element.name}}</td>
                    </ng-container>
    
                    <ng-container matColumnDef="no_of_recipients">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Recipients</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">{{element.no_of_recipients}}</td>
                    </ng-container>
                    
                    <ng-container matColumnDef="no_of_times_used">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Times Used</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">{{element.no_of_times_used}}</td>
                    </ng-container>
      
                    <ng-container matColumnDef="archive">
                      <th mat-header-cell *matHeaderCellDef>
                        
                      </th>
                      <td mat-cell class="hover_details" *matCellDef="let element">
                        <ul class="actiion_list">
                          <li>
                            <a (click)="loader=true" [routerLink]="'/Emails/UpdateTemplate/'+element.id" class="btn-orange-outline-border"
                            style="cursor: pointer;">Update</a>
                          </li>
                          <li>
                            <a class="btn-orange-outline-border" mwlConfirmationPopover [popoverTitle]="deletePopoverTitle"
                          [popoverMessage]="deletePopoverMessage" placement="left" (confirm)="archive(element)">Archive</a>
                          </li>
                        </ul>
                    </td>
                    </ng-container>
      
                    <tr mat-header-row *matHeaderRowDef="displayedColumnsEmailTemplates"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumnsEmailTemplates;"
                      (click)="$event.stopPropagation()">
                    </tr>
      
                  </table>
      
                  <app-custom-pagination [page]="allTemplatesPage" (nextPageEvent)="getTemplatesNextPage()"
                    (previousPageEvent)="getTemplatesPreviousPage()">
                  </app-custom-pagination>
      
                </div>
      
              </mat-tab>
<<<<<<< HEAD
              <mat-tab label="Mapped Email Templates (451)">
=======
              <mat-tab label="Mapped Email Templates ({{allMappedTemplates.totalElements}})">
>>>>>>> 283fbbfd1a39e2b7bb38af6e0ca912d4587bcd59
                <div class="menu_dot_area">
                  <button  class="border btn pr-3 pt-2 pb-2 pl-3" [matMenuTriggerFor]="menu_3">
                    <i class="fas fa-ellipsis-v"></i>
                  </button>
                  <mat-menu #menu_3="matMenu">
                    <a href="javascript:void(0)" mat-menu-item>Show/Hide Archive  &nbsp;
                      <mat-slide-toggle [(ngModel)]="isChecked"></mat-slide-toggle>
                    </a>
                    <a href="javascript:void(0)" mat-menu-item>
                      Unsubscribed Recipients
                    </a>
                  </mat-menu>
                </div> 
                <div class="table-container">
                  <table mat-table [dataSource]="emailTemplatesMappedToCertificatesDataSource" class="table hoverEffect table-header table-bordered table-rounded">
      
                    <ng-container matColumnDef="created_on">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Created</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">
                        <!-- {{element.created_at}} -->
                        Today 
                      </td>
                    </ng-container>
      
                    <ng-container matColumnDef="subject">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Subject</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">New Course Launched – Python and...</td>
                    </ng-container>

                    <ng-container matColumnDef="email_templates">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Email Templates</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">{{element.name}}</td>
                    </ng-container>

                    <ng-container matColumnDef="no_of_recipients">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Recipients</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">{{element.no_of_recipients}}</td>
                    </ng-container>
                   
                    <ng-container matColumnDef="no_of_times_used">
                      <th mat-header-cell *matHeaderCellDef>
                        <h6>Times Used</h6>
                      </th>
                      <td mat-cell *matCellDef="let element let rowIndex = index">{{element.no_of_times_used}}</td>
                    </ng-container>

                    <ng-container matColumnDef="update">
                      <th mat-header-cell *matHeaderCellDef>
                      </th>

                      <td mat-cell class="hover_details" *matCellDef="let element">
                        <ul class="actiion_list">
                          <li>
                            <a [routerLink]="'/Emails/AddTemplate/'+element.id+'/mapped'" class="btn-orange-outline-border">Update</a>
                          </li>
                          <li>
                            <a  [routerLink]="" class="btn-orange-outline-border" (click)="archive(element)" > Archive</a>
                          </li>
                        </ul>
                    </td>
                    </ng-container>
      
                    <tr mat-header-row *matHeaderRowDef="displayedColumnsMappedEmailTemplates"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumnsMappedEmailTemplates;"
                      (click)="$event.stopPropagation()">
                    </tr>
      
                  </table>
                  <app-custom-pagination [page]="allMappedTemplatesPage" (nextPageEvent)="getMappedTemplatesNextPage()"
                    (previousPageEvent)="getMappedTemplatesPreviousPage()">
                  </app-custom-pagination>
                </div>
              </mat-tab>
            </div>
          
        </mat-tab-group>
        <div class="loading-indicator">
          <mat-spinner *ngIf="loader" mode="indeterminate"></mat-spinner>
        </div>
      </div>
    </div>
  </div>
</div>