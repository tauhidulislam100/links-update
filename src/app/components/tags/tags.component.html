<!--<app-navbar></app-navbar>-->
<div class="container mt-5">
  <div class="box-area">
    <div class="row">
      <div class="col-md-12">
        <app-errors></app-errors>
        <div class="alert alert-success mb-5" role="alert" *ngIf="isTagUpdated">
          <div class="row align-items-center">
             <div class="col">
              <i class="fas fa-check-circle mr-2"></i>
               Tag is updated successfully.
             </div>
             <div class="col-auto">
               <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <i class="fas fa-times-circle"></i>
               </button>
             </div>
          </div>
       </div>
        <div class="alert alert-success mb-5" role="alert" *ngIf="tagAlreadyExists">
          <div class="row align-items-center">
             <div class="col">
              <i class="fas fa-check-circle mr-2"></i>
                 Tag Already Exists.
             </div>
             <div class="col-auto">
               <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <i class="fas fa-times-circle"></i>
               </button>
             </div>
          </div>
       </div>
        <div class="alert alert-success mb-5" role="alert" *ngIf="isFieldDeleted">
          <div class="row align-items-center">
             <div class="col">
              <i class="fas fa-check-circle mr-2"></i>
               Field is deleted successfully.
             </div>
             <div class="col-auto">
               <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <i class="fas fa-times-circle"></i>
               </button>
             </div>
          </div>
       </div>
        <div class="alert alert-success mb-5" role="alert" *ngIf="fieldAlreadyExists">
          <div class="row align-items-center">
             <div class="col">
              <i class="fas fa-check-circle mr-2"></i>
              Field Already Exists.
             </div>
             <div class="col-auto">
               <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <i class="fas fa-times-circle"></i>
               </button>
             </div>
          </div>
       </div>
        <div class="alert alert-success mb-5" role="alert" *ngIf="isTagAdded">
          <div class="row align-items-center">
             <div class="col">
              <i class="fas fa-check-circle mr-2"></i>
              Tag is added successfully.
             </div>
             <div class="col-auto">
               <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <i class="fas fa-times-circle"></i>
               </button>
             </div>
          </div>
       </div>
        <div class="alert alert-success mb-5" role="alert" *ngIf="isFieldAdded">
          <div class="row align-items-center">
             <div class="col">
              <i class="fas fa-check-circle mr-2"></i>
              Field is added successfully.
             </div>
             <div class="col-auto">
               <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <i class="fas fa-times-circle"></i>
               </button>
             </div>
          </div>
       </div>

        <mat-tab-group class="mat-group-content" [selectedIndex]="selectedTab" (selectedTabChange)="handleTabChange($event)">
          <mat-tab label="Tags">
            <button class="btn-orange-outline add_button"
            (click)="addTag()"> <i class="fas fa-plus"></i> Add New Tag
            </button>
            <form [formGroup]="tagsForm">
              <div class="table-container">
                <table mat-table [dataSource]="dataSource" class="mat-elevation-z8"
                      class="table table-bordered table-rounded">
                  <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef>
                      <h6>Id</h6>
                    </th>
                    <td mat-cell *matCellDef="let element let rowIndex = index">{{element.id}}</td>
                  </ng-container>
                  <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef>
                      <h6>Tags</h6>
                    </th>
                    <td mat-cell *matCellDef="let element let rowIndex = index">{{element.name}}</td>
                  </ng-container>
                  <ng-container matColumnDef="created_on">
                    <th mat-header-cell *matHeaderCellDef>
                      <h6>Created On</h6>
                    </th>
                    <td mat-cell *matCellDef="let element let rowIndex = index">
                      {{element.created_at}} </td>

                  </ng-container>
                  <ng-container matColumnDef="no_of_recipients">
                    <th mat-header-cell *matHeaderCellDef>
                      <h6>No of Recipients</h6>
                    </th>
                    <td mat-cell *matCellDef="let element let rowIndex = index">
                      {{element.no_of_recipients}} </td>
                  </ng-container>


                  <ng-container matColumnDef="update_tag">
                    <th mat-header-cell *matHeaderCellDef>
                      <img src="{{assets_loc}}assets/update-tag.svg"/>
                    </th>
                    <td mat-cell *matCellDef="let element; let rowIndex = index" (click)="$event.stopPropagation()">
                      <a [routerLink]="" (click)="updateTag(element.id)" class="view-link">Update</a>
                  </ng-container>
                  <ng-container matColumnDef="view_users">
                    <th mat-header-cell *matHeaderCellDef>
                      <img src="{{assets_loc}}assets/view-users.png"/>
                    </th>
                    <td mat-cell *matCellDef="let element; let rowIndex = index" (click)="$event.stopPropagation()">
                      <a (click)="loader = true" [routerLink]="'/Recipients/'+element.id" class="view-link">View
                        Recipients</a>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="displayedColumnsTags"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumnsTags;" (click)="clicked(row)">
                  </tr>
                </table>
                <app-custom-pagination
                  [page]="tagsPage"
                  (nextPageEvent)="getNextTagsPage()"
                  (previousPageEvent)="getPreviousTagsPage()"
                ></app-custom-pagination>
              </div>
            </form>
          </mat-tab>
          <mat-tab label="Fields">
            <button class="btn-orange-outline add_button" (click)="addField()"><i class="fas fa-plus"></i> Add New
              Field
            </button>
            <form [formGroup]="fieldsForm">
              <div class="table-container">
                <table mat-table [dataSource]="fieldsDataSource" class="mat-elevation-z8"
                      class="table table-bordered table-rounded">
                  <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef>
                      <h6>Id</h6>
                    </th>
                    <td mat-cell *matCellDef="let element let rowIndex = index">{{element.id}}</td>
                  </ng-container>
                  <ng-container matColumnDef="fields">
                    <th mat-header-cell *matHeaderCellDef>
                      <h6>Fields</h6>
                    </th>
                    <td mat-cell *matCellDef="let element let rowIndex = index">{{element.name}}</td>
                  </ng-container>
                  <ng-container matColumnDef="created_on">
                    <th mat-header-cell *matHeaderCellDef>
                      <h6>Created On</h6>
                    </th>
                    <td mat-cell *matCellDef="let element let rowIndex = index">{{element.created_at}}</td>

                  </ng-container>

                  <ng-container matColumnDef="delete">
                    <th mat-header-cell *matHeaderCellDef>
                      <img src="{{assets_loc}}assets/delete.svg"/>
                    </th>
                    <td mat-cell *matCellDef="let element; let rowIndex = index" (click)="$event.stopPropagation()">
                      <a
                        mwlConfirmationPopover
                        [popoverTitle]="fieldDeletePopoverTitle"
                        [popoverMessage]="fieldDeletePopoverMessage"
                        placement="left"
                        (confirm)="deleteField(element.id)"
                        class="view-link">Delete</a></td>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="displayedColumnsFields"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumnsFields;" (click)="clicked(row)">
                  </tr>
                </table>
                <app-custom-pagination
                  [page]="fieldsPage"
                  (nextPageEvent)="getNextFieldsPage()"
                  (previousPageEvent)="getPreviousFieldsPage()"
                ></app-custom-pagination>

              </div>
            </form>
          </mat-tab>
        </mat-tab-group>
      </div>
    </div>
  </div>
</div>

<div class="loading-indicator">
  <mat-spinner *ngIf="loader" mode="indeterminate"></mat-spinner>
</div>


